# F008 - 補助金申請功能

**狀態:** 已完成  
**優先級:** 高  
**預計完成日期:** 已完成  
**負責人:** 開發團隊

## 1. 功能概述

補助金申請功能允許學生申請各種學習和活動相關的財務補助，如課程費用、研討會參與費用或其他教育相關開支。系統提供完整的申請流程，包括資料收集、文件上傳和申請狀態追蹤。

## 2. 需求規格

### 2.1 功能需求

- 提供直觀的補助金申請表單，收集申請者資訊和補助金相關資料
- 支持不同類型補助金申請（學費補助、活動費用補助、研究經費等）
- 允許學生填寫補助金詳情，包括金額和用途
- 支持上傳相關憑證和證明文件
- 表單提交前進行資料驗證，確保必填欄位完整
- 提交後生成唯一申請編號，便於追蹤
- 顯示申請提交成功的確認消息
- 狀態追蹤功能，顯示申請是否已審核、通過或駁回
- 支持審核者添加審核意見和調整補助金額

### 2.2 相關需求文檔

- 補助金申請表單實現在 `src/views/Applications/SubsidyApplication.vue`
- 申請狀態和數據管理在 `src/stores/application.js`
- 模擬數據和處理邏輯在 `src/mocks/domains/applications/`

## 3. 使用者故事

**作為** 神學院學生，  
**我希望** 能夠線上申請學習相關的財務補助，  
**以便** 獲得支持來參加特殊課程或活動。

**作為** 申請學生，  
**我希望** 能夠上傳費用證明和相關文件，  
**以便** 支持我的補助金申請。

**作為** 財務管理人員，  
**我希望** 能夠審核補助金申請並查看相關證明，  
**以便** 做出合適的資金分配決定。

**作為** 學校行政人員，  
**我希望** 能夠監控補助金申請和分配情況，  
**以便** 進行預算管理和財務規劃。

## 4. 流程設計

### 4.1 業務流程

1. 學生登入系統
2. 學生訪問補助金申請頁面
3. 選擇補助金類型
4. 填寫申請表單，包括個人資訊和補助金詳情
5. 上傳費用證明和相關文件
6. 系統驗證表單資料
7. 提交申請並獲得唯一申請編號
8. 財務管理人員審核申請
9. 學生可查看申請狀態和結果

### 4.2 使用流程

**學生提交申請：**

1. 進入補助金申請頁面
2. 選擇補助金類型（下拉選單）
3. 填寫個人基本資料（姓名、學號、聯絡方式）
4. 填寫補助金詳情（金額、用途、日期等）
5. 上傳相關證明文件（收據、發票等）
6. 提交申請並接收確認訊息

**財務管理人員審核：**

1. 查看待審核的補助金申請
2. 審閱申請詳情和證明文件
3. 輸入批准的金額（可與申請金額不同）
4. 提供審核意見
5. 批准或駁回申請

### 4.3 狀態轉換

- 新申請 -> 待審核：學生提交申請後
- 待審核 -> 已通過：管理員批准申請
- 待審核 -> 已駁回：管理員駁回申請
- 已通過 -> 已撥款：財務部門完成撥款程序

## 5. 技術設計

### 5.1 架構設計

補助金申請功能基於 Vue 3 + Pinia 實現：

- 前端使用 Vue 3 和 Ant Design Vue 構建表單界面
- 使用 Pinia 進行狀態管理和表單數據處理
- 使用檔案上傳組件處理憑證和文件
- 使用表單驗證確保數據完整性和正確性
- 使用 sessionStorage 在測試環境中暫存申請數據

### 5.2 數據模型

```
// 補助金申請數據模型
subsidyApplication: {
  id: String,                  // 申請編號 (格式: SUB-YYYY-NNN)
  type: String,                // 申請類型 ("subsidy")
  subsidyType: String,         // 補助金類型 (學費/活動費/研究經費等)
  name: String,                // 申請者姓名
  studentId: String,           // 學號
  email: String,               // 電子郵件
  tel: String,                 // 電話號碼
  applicationDate: String,     // 申請日期 (YYYY/MM/DD)
  requestAmount: Number,       // 申請金額
  approvedAmount: Number,      // 核准金額
  purpose: String,             // 補助金用途
  activityDate: String,        // 活動/課程日期 (YYYY/MM/DD)
  documents: Array,            // 證明文件列表
  status: Number,              // 申請狀態 (0: 待審核, 1: 已通過, 2: 已駁回, 3: 已撥款)
  reviewDate: String,          // 審核日期 (YYYY/MM/DD)
  reviewer: String,            // 審核者
  reviewComment: String        // 審核意見
}
```

### 5.3 API 設計

在目前實現中，前端使用模擬數據，未來可擴展為以下 API：

| 方法 | 路徑                       | 描述           | 參數                   | 返回值       |
| ---- | -------------------------- | -------------- | ---------------------- | ------------ |
| POST | `/application`             | 提交申請       | 申請表單數據           | 申請結果     |
| POST | `/uploadDocument`          | 上傳文件       | 文件數據               | 文件訪問 URL |
| GET  | `/applicationList`         | 獲取申請列表   | 無                     | 申請列表     |
| PUT  | `/updateApplicationStatus` | 更新申請狀態   | id, status, reviewData | 更新結果     |
| GET  | `/subsidyTypes`            | 獲取補助金類型 | 無                     | 類型列表     |

### 5.4 依賴關係

- 依賴 `src/stores/application.js` 進行申請狀態管理
- 依賴 Ant Design Vue 提供表單和上傳組件
- 依賴 `src/mocks/domains/applications/` 提供模擬數據和處理邏輯
- 依賴 `src/schemas/subsidyForm.schema.js` 提供表單驗證規則

## 6. UI/UX 設計

### 6.1 頁面設計

- 表單採用清晰的分段結構，使用卡片式布局
- 頁面頂部有明確的標題「補助金申請」
- 表單分為三個主要區塊：個人資訊、補助金詳情、文件上傳
- 使用漸進式顯示：先選擇補助金類型，再顯示相應的詳細表單
- 底部提供提交和重置按鈕

### 6.2 交互設計

- 補助金類型選擇器會動態調整後續表單欄位
- 輸入欄位提供即時驗證反饋
- 金額輸入提供數字格式化和貨幣符號
- 文件上傳區塊提供拖放或點擊上傳功能
- 上傳完成後顯示文件預覽和刪除選項
- 提交按鈕在處理過程中顯示載入狀態
- 提交成功後顯示確認對話框，包含申請編號

### 6.3 頁面元素

- 補助金類型選擇下拉選單
- 個人資料輸入欄位（姓名、學號、電子郵件、電話）
- 補助金詳情（金額、用途、日期）
- 用途多行文本輸入
- 金額輸入框（數字格式）
- 日期選擇器
- 文件上傳組件
- 提交和重置按鈕
- 成功提示對話框

## 7. 測試計劃

### 7.1 測試策略

- 前端單元測試：驗證表單組件和校驗邏輯
- 文件上傳測試：確保文件可正確上傳和預覽
- 狀態管理測試：確保 Pinia store 正確處理申請數據
- 整合測試：驗證表單提交和狀態更新流程
- 使用者測試：確保表單易於理解和填寫

### 7.2 測試案例

| 測試 ID | 測試描述       | 測試步驟                                              | 期望結果                       | 前置條件           |
| ------- | -------------- | ----------------------------------------------------- | ------------------------------ | ------------------ |
| TC001   | 表單校驗測試   | 1. 不填寫必填欄位<br>2. 點擊提交按鈕                  | 顯示錯誤提示，阻止提交         | 訪問補助金申請頁面 |
| TC002   | 金額輸入測試   | 1. 輸入非數字字符<br>2. 輸入負數                      | 顯示錯誤提示，阻止輸入         | 訪問補助金申請頁面 |
| TC003   | 文件上傳測試   | 1. 點擊上傳區域<br>2. 選擇文件上傳                    | 文件成功上傳並顯示預覽         | 訪問補助金申請頁面 |
| TC004   | 補助金類型測試 | 1. 選擇不同類型補助金<br>2. 觀察表單變化              | 表單欄位根據類型動態調整       | 訪問補助金申請頁面 |
| TC005   | 成功提交測試   | 1. 填寫所有必填欄位<br>2. 上傳文件<br>3. 點擊提交按鈕 | 顯示成功提示，包含唯一申請編號 | 訪問補助金申請頁面 |

## 8. 開發計劃

### 8.1 工作拆分

| 任務             | 估算時間 | 負責人   |
| ---------------- | -------- | -------- |
| 表單 UI 設計     | 已完成   | 開發團隊 |
| 動態表單邏輯     | 已完成   | 開發團隊 |
| 表單驗證邏輯     | 已完成   | 開發團隊 |
| 文件上傳功能     | 已完成   | 開發團隊 |
| Pinia store 實現 | 已完成   | 開發團隊 |
| 申請狀態管理     | 已完成   | 開發團隊 |
| 模擬數據設計     | 已完成   | 開發團隊 |
| 表單提交功能     | 已完成   | 開發團隊 |
| 整體功能測試     | 已完成   | 開發團隊 |

### 8.2 里程碑

| 日期   | 里程碑             |
| ------ | ------------------ |
| 已完成 | 表單界面設計和實現 |
| 已完成 | 動態表單邏輯實現   |
| 已完成 | 文件上傳功能實現   |
| 已完成 | 資料驗證和提交功能 |
| 已完成 | 申請狀態管理和紀錄 |
| 已完成 | 整合測試和功能完善 |

## 9. 狀態追蹤

### 9.1 開發進度

補助金申請功能已完成並整合到系統中。

### 9.2 問題記錄

| 日期 | 問題描述 | 狀態 | 解決方案 |
| ---- | -------- | ---- | -------- |
| -    | -        | -    | -        |

## 10. 備註

- 目前申請數據儲存在前端 sessionStorage，實際上線後需要整合後端 API
- 未來可考慮實現補助金預算管理功能，監控總補助金額和剩餘預算
- 考慮增加財務報表功能，方便管理者查看補助金分配情況
- 可增加學期或年度的補助金上限設定
- 未來可實現電子通知功能，通知申請人審核結果
