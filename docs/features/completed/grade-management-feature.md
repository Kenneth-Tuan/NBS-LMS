# F010 - 成績管理功能

**狀態:** 已完成  
**優先級:** 高  
**預計完成日期:** 已完成  
**負責人:** 開發團隊

## 1. 功能概述

成績管理功能允許教師輸入、管理和發布學生的課程成績，同時讓學生能夠查看自己的成績和學習進度。系統支持多種成績評量方式，包括平時作業、期中考試、期末考試和專題項目等，並提供成績統計和分析功能。

## 2. 需求規格

### 2.1 功能需求

- 教師能夠建立和管理課程成績項目與權重
- 支持多種成績評量方式（考試、作業、專題、參與度等）
- 批量和個別輸入學生成績功能
- 成績計算與加權平均功能
- 成績曲線調整功能
- 學生成績查詢與歷史記錄
- 學期和累計 GPA 計算
- 成績分布統計和分析功能
- 成績單生成與下載功能
- 成績審核與發布管理
- 成績變更記錄和追蹤功能

### 2.2 相關需求文檔

- 教師成績管理頁面實現在 `src/views/Grades/TeacherGradeManagement.vue`
- 學生成績查詢頁面實現在 `src/views/Grades/StudentGradeView.vue`
- 成績數據和狀態管理在 `src/stores/grade.js`
- 模擬數據和處理邏輯在 `src/mocks/domains/grades/`

## 3. 使用者故事

**作為** 神學院教師，  
**我希望** 能夠輕鬆輸入和管理學生的各項成績資料，  
**以便** 準確評估學生的學習成果並及時提供反饋。

**作為** 授課教師，  
**我希望** 能夠設定不同的成績評量項目和權重，  
**以便** 根據課程特性制定適合的評分標準。

**作為** 神學院學生，  
**我希望** 能夠查看我的各項成績和 GPA 計算結果，  
**以便** 了解我的學習狀況和進度。

**作為** 教務處職員，  
**我希望** 獲取全校成績統計和分析數據，  
**以便** 評估課程和教學質量，並制定相應的改進措施。

## 4. 流程設計

### 4.1 業務流程

1. 教師設定課程評分標準和項目權重
2. 教師記錄學生的各項成績
3. 教師檢視班級成績分布和統計
4. 教師評定最終成績並提交
5. 教務處審核成績
6. 成績發布給學生
7. 學生查看個人成績和統計
8. 如有必要，處理成績更正請求

### 4.2 使用流程

**教師成績管理流程：**

1. 登入系統進入教師成績管理頁面
2. 選擇課程和學期
3. 建立評分項目和權重
4. 輸入學生各項成績數據
5. 查看成績統計和分析
6. 調整或確認最終成績
7. 提交成績供審核發布

**學生成績查詢流程：**

1. 登入系統進入學生成績頁面
2. 查看當前學期課程成績
3. 訪問成績歷史記錄
4. 查看學期和累計 GPA
5. 下載或打印成績單

### 4.3 狀態轉換

- 未評分 -> 已評分：教師完成成績輸入
- 已評分 -> 待審核：教師提交成績待審核
- 待審核 -> 已發布：教務處完成審核並發布成績
- 已發布 -> 成績異議：學生提出成績異議
- 成績異議 -> 成績更正：教師更正成績後重新審核發布

## 5. 技術設計

### 5.1 架構設計

成績管理功能基於 Vue 3 + Pinia 實現：

- 前端使用 Vue 3 和 Ant Design Vue 構建界面
- 使用 Pinia 進行成績數據和狀態管理
- 使用 Vue Router 處理頁面導航和參數
- 使用表格組件展示成績列表，支持排序和篩選
- 使用圖表組件展示成績分布和統計
- 使用 sessionStorage 在測試環境中暫存成績數據

### 5.2 數據模型

```
// 課程評分標準數據模型
gradeSchema: {
  courseId: String,           // 課程編號
  term: String,               // 學期
  components: [               // 評分組件列表
    {
      id: String,             // 組件ID
      name: String,           // 組件名稱（如：期中考、作業等）
      weight: Number,         // 權重百分比
      minScore: Number,       // 最低分數
      maxScore: Number,       // 最高分數
      items: [                // 子項目列表
        {
          id: String,         // 項目ID
          name: String,       // 項目名稱（如：作業一、作業二）
          weight: Number,     // 在組件中的權重
          dueDate: Date,      // 截止日期
          maxScore: Number    // 最高分數
        }
      ]
    }
  ],
  letterGradeSchema: Object,  // 字母成績轉換標準（如：A=90-100）
  status: String,             // 評分方案狀態（草稿/已確認）
}

// 學生成績數據模型
studentGrade: {
  studentId: String,          // 學生ID
  courseId: String,           // 課程ID
  term: String,               // 學期
  grades: [                   // 各項成績列表
    {
      componentId: String,    // 組件ID
      itemId: String,         // 項目ID
      score: Number,          // 得分
      feedback: String,       // 教師反饋
      submittedAt: Date,      // 提交時間
      gradedAt: Date          // 評分時間
    }
  ],
  finalScore: Number,         // 最終分數
  letterGrade: String,        // 字母成績
  gpa: Number,                // GPA換算值
  status: String,             // 成績狀態（進行中/已評分/已發布）
  comments: String,           // 總體評語
  lastUpdatedBy: String,      // 最後更新者
  lastUpdatedAt: Date         // 最後更新時間
}

// 成績統計數據模型
gradeStatistics: {
  courseId: String,           // 課程ID
  term: String,               // 學期
  studentCount: Number,       // 學生數量
  averageScore: Number,       // 平均分數
  medianScore: Number,        // 中位數分數
  highestScore: Number,       // 最高分數
  lowestScore: Number,        // 最低分數
  standardDeviation: Number,  // 標準差
  distribution: Object,       // 分數分布
  componentStatistics: Array, // 各評分組件統計
}
```

### 5.3 API 設計

在目前實現中，前端使用模擬數據，未來可擴展為以下 API：

| 方法 | 路徑                            | 描述             | 參數                    | 返回值           |
| ---- | ------------------------------- | ---------------- | ----------------------- | ---------------- |
| GET  | `/grades/courses/:courseId`     | 獲取課程成績列表 | courseId, term          | 課程學生成績列表 |
| GET  | `/grades/student/:studentId`    | 獲取學生成績記錄 | studentId, term         | 學生所有課程成績 |
| GET  | `/grades/schema/:courseId`      | 獲取課程評分標準 | courseId, term          | 課程評分標準詳情 |
| POST | `/grades/schema`                | 創建課程評分標準 | gradeSchemaObject       | 創建結果         |
| PUT  | `/grades/schema/:schemaId`      | 更新課程評分標準 | schemaId, updatedSchema | 更新結果         |
| POST | `/grades/student`               | 記錄學生成績     | studentGradeObject      | 記錄結果         |
| PUT  | `/grades/student/:gradeId`      | 更新學生成績     | gradeId, updatedGrade   | 更新結果         |
| GET  | `/grades/statistics/:courseId`  | 獲取成績統計數據 | courseId, term          | 成績統計數據     |
| POST | `/grades/publish`               | 發布課程成績     | courseId, term          | 發布結果         |
| GET  | `/grades/transcript/:studentId` | 獲取學生成績單   | studentId, terms        | 成績單數據       |

### 5.4 依賴關係

- 依賴 `src/stores/grade.js` 進行成績數據管理
- 依賴 `src/stores/course.js` 獲取課程資訊
- 依賴 `src/stores/user.js` 獲取學生和教師資訊
- 依賴 Ant Design Vue 提供表格、表單和圖表組件
- 依賴 `src/mocks/domains/grades/` 提供模擬數據和處理邏輯
- 依賴 `src/utils/gradeUtils.js` 處理成績計算和轉換

## 6. UI/UX 設計

### 6.1 頁面設計

- 教師成績管理頁面採用分頁式布局：
  - 評分標準設置頁
  - 學生成績輸入頁
  - 成績統計分析頁
  - 成績審核與發布頁
- 學生成績查詢頁面包含：
  - 當前學期成績卡片式展示
  - 歷史成績表格式展示
  - GPA 趨勢圖表
  - 成績單生成與下載區域

### 6.2 交互設計

- 教師成績管理頁面：
  - 支持批量和單個學生成績輸入切換
  - 即時成績計算與預覽
  - 拖拽調整評分項目權重
  - 成績分布直方圖動態更新
  - 成績表格支持多條件排序和篩選
  - 提供 Excel 格式導入導出功能
- 學生成績查詢頁面：
  - 各課程成績卡片支持展開顯示詳細評分項目
  - 學期選擇器切換不同學期成績
  - GPA 圖表支持多種視圖（學期趨勢、課程類別分析等）
  - 成績單格式預覽和自定義下載選項

### 6.3 頁面元素

- 成績輸入表格與表單
- 評分標準設置面板
- 成績統計圖表（直方圖、餅圖、折線圖等）
- 學生列表與成績過濾器
- 成績狀態標籤與指示器
- 批量操作工具列
- GPA 計算器與顯示區域
- 成績單生成工具
- 導入導出按鈕和配置面板

## 7. 測試計劃

### 7.1 測試策略

- 前端單元測試：驗證成績計算邏輯和數據處理
- 成績評分方案測試：確保評分標準設置正確
- 成績計算與統計測試：驗證加權平均和 GPA 計算準確性
- 狀態管理測試：確保 Pinia store 正確處理成績數據
- 整合測試：驗證成績管理流程的完整性
- 使用者測試：確保界面易於使用和理解

### 7.2 測試案例

| 測試 ID | 測試描述         | 測試步驟                                     | 期望結果                          | 前置條件             |
| ------- | ---------------- | -------------------------------------------- | --------------------------------- | -------------------- |
| TC001   | 評分標準創建測試 | 1. 設置評分項目和權重<br>2. 保存評分標準     | 成功創建評分標準並應用於課程      | 登入為教師用戶       |
| TC002   | 成績輸入測試     | 1. 為學生輸入各項成績<br>2. 保存成績數據     | 成績數據成功保存並計算最終分數    | 已創建評分標準       |
| TC003   | 成績計算測試     | 1. 輸入不同項目分數<br>2. 檢查最終分數和 GPA | 根據權重正確計算加權平均和 GPA    | 已輸入部分成績數據   |
| TC004   | 成績統計測試     | 1. 完成班級成績輸入<br>2. 檢視成績統計和分布 | 顯示準確的班級成績統計和分布圖    | 已輸入班級完整成績   |
| TC005   | 成績發布測試     | 1. 確認成績並提交<br>2. 審核並發布成績       | 成績成功發布並對學生可見          | 已完成成績輸入和計算 |
| TC006   | 學生成績查詢測試 | 1. 學生登入<br>2. 查看當前學期和歷史成績     | 學生能正確查看所有成績和 GPA 數據 | 已發布學生成績       |

## 8. 開發計劃

### 8.1 工作拆分

| 任務                 | 估算時間 | 負責人   |
| -------------------- | -------- | -------- |
| 評分標準設置功能設計 | 已完成   | 開發團隊 |
| 學生成績輸入界面實現 | 已完成   | 開發團隊 |
| 成績計算邏輯實現     | 已完成   | 開發團隊 |
| 成績統計與分析功能   | 已完成   | 開發團隊 |
| 成績發布與審核流程   | 已完成   | 開發團隊 |
| 學生成績查詢頁面設計 | 已完成   | 開發團隊 |
| GPA 計算與展示功能   | 已完成   | 開發團隊 |
| 成績單生成功能       | 已完成   | 開發團隊 |
| 批量導入導出功能     | 已完成   | 開發團隊 |
| 整體功能測試         | 已完成   | 開發團隊 |

### 8.2 里程碑

| 日期   | 里程碑                 |
| ------ | ---------------------- |
| 已完成 | 評分標準設置功能       |
| 已完成 | 學生成績輸入與計算功能 |
| 已完成 | 成績統計與分析功能     |
| 已完成 | 成績審核與發布功能     |
| 已完成 | 學生成績查詢功能       |
| 已完成 | GPA 計算與成績單功能   |
| 已完成 | 整合測試和功能完善     |

## 9. 狀態追蹤

### 9.1 開發進度

成績管理功能已完成並整合到系統中。

### 9.2 問題記錄

| 日期 | 問題描述 | 狀態 | 解決方案 |
| ---- | -------- | ---- | -------- |
| -    | -        | -    | -        |

## 10. 備註

- 目前成績數據儲存在前端 sessionStorage，實際上線後需要整合後端 API
- 未來可考慮實現成績分析趨勢功能，幫助教師評估課程教學效果
- 可增加學生成績自評和教師評語功能，提供更豐富的學習反饋
- 考慮增加成績異議和申訴流程，處理特殊情況
- 可實現成績推送通知功能，在成績發布時通知學生
- 未來可增加成績預警系統，及早識別學習困難的學生提供支援
