# 管理功能規格說明書

## 1. 用戶管理

### 1.1 管理員權限分級

#### Admin 權限

- 系統最高權限
- 可進行所有管理操作
- 可管理其他管理員帳號

#### Manager 權限

- 無法新增/刪除管理員帳號
- 無法修改系統參數設定
- 可執行其他一般管理功能

### 1.2 用戶帳號管理

#### 新增用戶

1. 操作流程

   - 點選「新增用戶」按鈕
   - 填寫用戶資料表單：
     - 必填項目：
       - 用戶名（學號/工號）
       - 姓名
       - 密碼
       - 角色（學生/教師/管理員）
       - Email
     - 選填項目：
       - 聯絡電話
       - 備註
   - 提交表單
   - 系統驗證資料
   - 創建帳號

2. 業務規則

   - 用戶名不可重複
   - 密碼需符合安全規則：
     - 至少 8 位字符
     - 必須包含大小寫字母和數字
     - 不能與用戶名相同
   - Manager 無權限新增管理員帳號
   - 批量導入功能：
     - 支援 Excel 檔案上傳
     - 提供標準範本下載
     - 上傳後系統自動驗證格式

3. 異常處理
   - 用戶名重複：顯示錯誤訊息
   - 密碼不符規則：顯示密碼規則提示
   - 必填欄位缺失：標示必填欄位
   - 批量導入格式錯誤：產生錯誤報告

#### 編輯用戶

1. 操作流程

   - 在用戶列表中選擇用戶
   - 點選「編輯」按鈕
   - 修改用戶資料
   - 提交變更
   - 系統記錄修改歷史

2. 可編輯項目

   - 基本資料（除用戶名外）
   - 用戶密碼
   - 用戶角色
   - 帳號狀態（啟用/停用）

3. 業務規則
   - Manager 無權修改管理員資料
   - 密碼重置需二次確認
   - 記錄所有修改歷史
   - 停用帳號需填寫原因

#### 刪除用戶

1. 操作流程

   - 選擇用戶
   - 點選「刪除」按鈕
   - 填寫刪除原因
   - 二次確認
   - 執行刪除

2. 業務規則
   - Manager 無權刪除管理員帳號
   - 刪除前檢查用戶相關數據
   - 軟刪除：保留數據但標記為已刪除
   - 記錄刪除操作歷史

### 1.3 用戶查詢功能

1. 查詢條件

   - 用戶名
   - 姓名
   - 角色
   - 帳號狀態
   - 創建日期範圍

2. 查詢結果顯示
   - 分頁顯示
   - 每頁顯示數量可選（10/20/50）
   - 可排序欄位：
     - 用戶名
     - 創建日期
     - 最後登入時間
3. 導出功能
   - 可導出 Excel 格式
   - 可選擇導出欄位
   - 記錄導出操作歷史

### 1.4 用戶操作日誌

1. 記錄內容

   - 操作時間
   - 操作人
   - 操作類型
   - 操作對象
   - 操作內容
   - IP 地址

2. 查詢功能

   - 可按時間範圍查詢
   - 可按操作類型查詢
   - 可按操作人查詢

3. 日誌保存
   - 保存期限：3 年
   - 定期備份
   - 可導出 Excel

## 2. 系統參數設定

### 2.1 系統基本設定

1. 連線設定

   - 使用者連線逾時時間（分鐘）
   - 最大同時連線數
   - 允許的 IP 範圍

2. 密碼政策設定

   - 密碼最小長度
   - 密碼複雜度要求
   - 密碼有效期（天）
   - 密碼重試次數限制

3. 系統維護設定
   - 系統備份時間
   - 日誌保存期限
   - 臨時檔案清理週期

### 2.2 介面設定

1. 語言設定

   - 系統預設語言：中文
   - 日期時間格式：YYYY-MM-DD HH:mm:ss
   - 數字格式設定

2. 介面顯示設定
   - 分頁預設筆數
   - 表格預設排序方式
   - 系統主題設定

### 2.3 參數修改流程

1. 操作流程

   - 選擇參數類別
   - 修改參數值
   - 填寫修改原因
   - 提交變更
   - 系統記錄修改歷史

2. 業務規則
   - 僅 Admin 可修改系統參數
   - 部分參數修改需要系統重啟
   - 記錄所有修改歷史
   - 可設定參數生效時間

## 3. 排課功能

### 3.1 課程基礎設定

1. 學期設定

   - 學年度設定
   - 學期起訖日期
   - 放假日期設定
   - 特殊上課日期設定

2. 時段設定

   - 課程時間單位（如 50 分鐘）
   - 每日時段設定
   - 休息時間設定

3. 教室資源設定
   - 教室基本資料
     - 教室編號
     - 容納人數
     - 設備清單
   - 教室使用限制
   - 特殊教室規則

### 3.2 排課作業

1. 操作流程

   - 匯入課程清單
   - 設定課程需求
     - 必要設備
     - 預估人數
     - 教師時間偏好
   - 執行自動/手動排課
   - 檢視衝突報告
   - 調整課程安排
   - 確認並發布課表

2. 衝突檢查

   - 教室時段衝突
   - 教師時段衝突
   - 必修課衝突
   - 容納人數檢查
   - 設備需求檢查

3. 特殊處理
   - 臨時調課處理
   - 教室借用處理
   - 跨校區課程安排
   - 連續課程安排

### 3.3 課表查詢與匯出

1. 查詢功能

   - 按教室查詢
   - 按教師查詢
   - 按課程查詢
   - 按時段查詢

2. 匯出功能
   - 匯出格式：Excel、PDF
   - 客製化匯出欄位
   - 批量匯出功能

## 4. 統計功能

### 4.1 學生個別成績統計

1. 統計條件

   - 學期選擇（如 2023 年上學期）
   - 學生選擇
   - 課程類別篩選

2. 統計內容

   - 各科目成績
   - 各科目學分
   - 學期總學分
   - 平均成績計算
   - 成績分布分析

3. 匯出功能
   - Excel 格式匯出
   - 自定義報表格式
   - 批量匯出功能

### 4.2 個人出缺席統計

1. 統計範圍

   - 按學期統計
   - 可選擇特定時間範圍
   - 可選擇特定課程

2. 統計項目

   - 出席次數
   - 缺席次數
   - 請假次數（按假別）
   - 出席率計算

3. 報表功能
   - 整合至成績單
   - 獨立報表匯出
   - 客製化報表格式

### 4.3 學生歷年修課統計

1. 統計維度

   - 按學年統計
   - 按學期統計
   - 按課程類別統計

2. 統計內容

   - 修課清單
   - 學分統計
   - 成績統計
   - 及格率分析

3. 報表功能
   - Excel 格式匯出
   - 圖表分析
   - 趨勢分析

### 4.4 教師開課紀錄

1. 統計內容

   - 課程基本資料
   - 開課次數統計
   - 選課人數統計
   - 歷年比較分析

2. 分析功能

   - 課程熱門度分析
   - 選課人數趨勢
   - 開課時段分析

3. 報表功能
   - Excel 格式匯出
   - 統計圖表生成
   - 客製化報表

### 4.5 共同功能

1. 數據更新機制

   - 即時統計
   - 定時更新
   - 手動更新選項

2. 數據呈現

   - 表格形式
   - 圖表視覺化
   - 數據鑽取功能

3. 報表管理
   - 報表範本管理
   - 報表存取權限
   - 報表產生記錄

## 5. 系統介面規格

### 5.1 RWD 自適應設計

1. 桌面版（≥1280px）

   - 完整功能展示
   - 多欄位同時顯示
   - 完整統計圖表

2. 平板版（768px~1279px）

   - 適當欄位收合
   - 圖表自適應縮放
   - 觸控優化介面

3. 手機版（360px~767px）
   - 單欄式排版
   - 簡化操作流程
   - 基礎功能優先

### 5.2 操作介面設計

1. 導航設計

   - 階層式選單
   - 快速功能鍵
   - 頁面導覽列

2. 操作流程

   - 步驟提示
   - 錯誤提示
   - 操作確認機制

3. 介面回饋
   - 載入提示
   - 操作成功/失敗提示
   - 系統狀態提示
